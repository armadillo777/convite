<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Convite de celebração de Carol e João</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
    body { font-family: Arial; padding: 20px; max-width: 600px; margin: auto; }
    h1 { color: #444; }
    .hidden { display: none; }
    label { display: block; margin-top: 15px; }
    input, select, textarea {
        width: 100%; padding: 10px; margin-top: 5px;
    }
    button {
        margin-top: 20px; padding: 10px 20px;
        background: #4CAF50; border: none; color: white; cursor: pointer;
        font-size: 16px;
    }
    #contador { background: #eee; padding: 10px; margin-top: 20px; font-weight: bold; }
</style>
</head>
<body>

<h1>Convite de celebração de Carol e João</h1>
<p>Preencha suas informações abaixo:</p>

<form id="form">
    <label>Seu nome completo:</label>
    <input type="text" id="nome" required>

    <label>Você estará presente?</label>
    <select id="presenca" required>
        <option value="">Selecione...</option>
        <option value="Sim">Sim</option>
        <option value="Não">Não</option>
    </select>

    <div id="acompanhantes-section" class="hidden">
        <label>Terá acompanhantes?</label>
        <select id="temAcompanhantes">
            <option value="Não">Não</option>
            <option value="Sim">Sim</option>
        </select>

        <div id="qtd-section" class="hidden">
            <label>Quantos acompanhantes?</label>
            <input type="number" id="qtd" min="1">
        </div>

        <div id="nomes-section" class="hidden">
            <label>Nomes completos dos acompanhantes:</label>
            <textarea id="nomesAcompanhantes"></textarea>
        </div>
    </div>

    <button type="submit">Enviar confirmação</button>
</form>

<div id="contador">Total confirmados: <span id="total-confirmados">0</span></div>

<script>
// Mostrar/ocultar campos
document.getElementById("presenca").addEventListener("change", function () {
    document.getElementById("acompanhantes-section").classList.toggle("hidden", this.value !== "Sim");
});

document.getElementById("temAcompanhantes").addEventListener("change", function () {
    const show = this.value === "Sim";
    document.getElementById("qtd-section").classList.toggle("hidden", !show);
    document.getElementById("nomes-section").classList.toggle("hidden", !show);
});

// Contador local
let totalConfirmados = localStorage.getItem("confirmados")
    ? parseInt(localStorage.getItem("confirmados"))
    : 0;

document.getElementById("total-confirmados").innerText = totalConfirmados;

// Envio automático ao Apps Script
document.getElementById("form").addEventListener("submit", function(e) {
    e.preventDefault();

    const nome = document.getElementById("nome").value;
    const presenca = document.getElementById("presenca").value;
    const temAcompanhantes = document.getElementById("temAcompanhantes").value;
    const qtd = document.getElementById("qtd").value || "0";
    const nomes = document.getElementById("nomesAcompanhantes").value || "Nenhum";

    // Atualiza contador
    if (presenca === "Sim") {
        totalConfirmados++;
        localStorage.setItem("confirmados", totalConfirmados);
        document.getElementById("total-confirmados").innerText = totalConfirmados;
    }

    const payload = {
        nome,
        presenca,
        acompanhantes: temAcompanhantes,
        qtd,
        nomes
    };

    // <<< SUBSTITUA AQUI PELA SUA URL DO APP SCRIPT >>>
    const endpoint = "https://script.google.com/macros/s/AKfycbziRdxEMNzMmepVQoz_rkf7nDV_sVSHCtj7sE9qVIhZN5aElWOtkhSR_1ciSn7z0Lwl/exec";

    fetch(endpoint, {
        method: "POST",
        body: JSON.stringify(payload),
        headers: { "Content-Type": "application/json" }
    });

    .then(response => response.json())
    .then(data => {
        console.log('Resposta do servidor:', data);
        alert("Confirmação enviada com sucesso!");
    })
    .catch(error => {
        console.error('Erro ao enviar dados:', error);
    });
</script>

</body>
</html>
